datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Wallet {
  id        String       @id @default(uuid())
  userId    String
  tenantId  String
  asset     String       // BTC, ETH, BRL, USDT
  balance   Decimal      @default(0) @db.Decimal(30, 18)
  locked    Decimal      @default(0) @db.Decimal(30, 18)
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  @@unique([userId, asset])
  @@index([tenantId])
}

model WalletTransaction {
  id        String   @id @default(uuid())
  walletId  String
  type      String   // DEPOSIT, WITHDRAWAL, TRADE_BUY, TRADE_SELL, FEE
  amount    Decimal  @db.Decimal(30, 18)
  asset     String
  refId     String?  // order ID, transfer ID
  createdAt DateTime @default(now())

  @@index([walletId, createdAt])
}